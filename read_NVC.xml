<tool id="read_NVC" name="Read NVC">
	<description>to check the nucleotide composition bias</description>
	<requirements>
		<requirement type="package" version="2.15.1">R</requirement>
		<requirement type="package" version="2.3.7">rseqc</requirement>
	</requirements>
	<command interpreter="python"> read_NVC.py -i $input -o output

		#if $nx
			-x
		#end if
	</command>
	<inputs>
		<param name="input" type="data" format="bam,sam" label="input bam/sam file" />
		<param name="nx" type="boolean" label="Include N,X in NVC plot" value="false" />
	</inputs>
	<outputs>
		<data format="xls" name="outputxls" from_work_dir="output.NVC.xls"/>
		<data format="r" name="outputr" from_work_dir="output.NVC_plot.r" />
		<data format="pdf" name="outputpdf" from_work_dir="output.NVC_plot.pdf" />
	</outputs>
	<help>
.. image:: https://code.google.com/p/rseqc/logo?cct=1336721062

-----

About RSeQC
+++++++++++

The RSeQC package provides a number of useful modules that can comprehensively evaluate high throughput sequence data especially RNA-seq data. “Basic modules” quickly inspect sequence quality, nucleotide composition bias, PCR bias and GC bias, while “RNA-seq specific modules” investigate sequencing saturation status of both splicing junction detection and expression estimation, mapped reads clipping profile, mapped reads distribution, coverage uniformity over gene body, reproducibility, strand specificity and splice junction annotation.

The RSeQC package is licensed under the GNU GPL v3 license.

Inputs
++++++++++++++

Input BAM/SAM file
	Alignment file in BAM/SAM format.

Include N,X in NVC plot
	Plots N and X alongside A, T, C, and G in plot.

Output
++++++++++++++

This module is used to check the nucleotide composition bias. Due to random priming, certain patterns are over represented at the beginning (5'end) of reads. This bias could be easily examined by NVC (Nucleotide versus cycle) plot. NVC plot is generated by overlaying all reads together, then calculating nucleotide composition for each position of read (or each sequencing cycle). In ideal condition (genome is random and RNA-seq reads is randomly sampled from genome), we expect A%=C%=G%=T%=25% at each position of reads.


1. output.NVC.xls: plain text file, each row is position of read (or sequencing cycle), each column is nucleotide (A,C,G,T,N,X)
2. output.NVC_plot.r: R script to generate NVC plot.
3. output.NVC_plot.pdf: NVC plot.


.. image:: http://dldcc-web.brc.bcm.edu/lilab/liguow/RSeQC/figure/NVC_plot.png

	</help>
</tool>
