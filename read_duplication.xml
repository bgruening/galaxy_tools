<tool id="read_duplication" name="Read Duplication">
	<description>determines reads duplication rate with sequence-based and mapping-based strategies</description>
	<requirements>
		<requirement type="package" version="2.15.1">R</requirement>
		<requirement type="package" version="2.3.7">rseqc</requirement>
	</requirements>
	<command interpreter="python"> read_duplication.py -i $input -o output -u $upLimit
	</command>
	<inputs>
		<param name="input" type="data" format="bam,sam" label="input bam/sam file" />
		<param name="upLimit" type="integer" label="Upper Limit of Plotted Duplicated Times (default=500)" value="500" />
	</inputs>
	<outputs>
		<data format="xls" name="outputxls" from_work_dir="output.dup.pos.DupRate.xls"/>
		<data format="xls" name="outputseqxls" from_work_dir="output.dup.seq.DupRate.xls"/>
		<data format="r" name="outputr" from_work_dir="output.DupRate_plot.r" />
		<data format="pdf" name="outputpdf" from_work_dir="output.DupRate_plot.pdf" />
	</outputs>
	<help>
.. image:: https://code.google.com/p/rseqc/logo?cct=1336721062

-----

About RSeQC
+++++++++++

The RSeQC package provides a number of useful modules that can comprehensively evaluate high throughput sequence data especially RNA-seq data. “Basic modules” quickly inspect sequence quality, nucleotide composition bias, PCR bias and GC bias, while “RNA-seq specific modules” investigate sequencing saturation status of both splicing junction detection and expression estimation, mapped reads clipping profile, mapped reads distribution, coverage uniformity over gene body, reproducibility, strand specificity and splice junction annotation.

The RSeQC package is licensed under the GNU GPL v3 license.

Inputs
++++++++++++++

Input BAM/SAM file
	Alignment file in BAM/SAM format.

Upper Limit of Plotted Duplicated Times (default=500)
	Only used for plotting.

Output
++++++++++++++

1. output.dup.pos.DupRate.xls: Read duplication rate determined from mapping position of read. First column is "occurrence" or duplication times, second column is number of uniquely mapped reads.
2. output.dup.seq.DupRate.xls: Read duplication rate determined from sequence of read. First column is "occurrence" or duplication times, second column is number of uniquely mapped reads.
3. output.DupRate_plot.r: R script to generate pdf file
4. output.DupRate_plot.pdf: graphical output generated from R script

.. image:: http://dldcc-web.brc.bcm.edu/lilab/liguow/RSeQC/figure/duplicate.png

	</help>
</tool>
